<!doctype html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simple Chatbot</title>
  <style>
    *,
    *::before,
    *::after {
      box-sizing: border-box;
    }

    html {
      font-family: sans-serif;
      line-height: 1.15;
      -webkit-text-size-adjust: 100%;
      -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
			font-size: 20px;
    }

    body {
      margin: 0;
      font-family: "Helvetica Neue",
	    Arial,
	    "Hiragino Kaku Gothic ProN",
	    "Hiragino Sans",
	    Meiryo,
	    sans-serif;
      font-size: 0.75rem;
      font-weight: 400;
      line-height: 1.5;
      color: #212529;
      text-align: left;
      background-color: #fff;
      margin: 50px;
    }

    h1 {
      text-align: center;
    }
  </style>
  <link rel="stylesheet" href="./chatbot/chatbot.css">
</head>

<body>

  <h1>Simple Chatbot</h1>

  <!-- chatbot-btn -->
  <div class="chatbot-btn">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 20 20" width="20" height="20">
      <path fill="currentColor"
        d="M14 8.999v-5a2.003 2.003 0 00-2-2H3a2.003 2.003 0 00-2 2v5a2.003 2.003 0 002 2v1.694a.302.302 0 00.486.244l2.587-1.945H12A1.997 1.997 0 0014 9zm3-2h-2v2a3.003 3.003 0 01-3 3H7v2a2.003 2.003 0 002 2h3.927l2.59 1.941c.198.15.483.004.483-.243v-1.701h1a2.003 2.003 0 002-1.997v-5a2.003 2.003 0 00-2-2z" />
    </svg>
    <div class="chatbot-toggle-tooltip">ご質問はありますか？</div>
  </div>


  <!-- FingerPrint JS -->
  <script src="./chatbot/fp2.js"></script>
  <!-- ChatBot JS -->
  <script src="./chatbot/chatbot.js"></script>

  <script>
    // 1 - Specifying the key in localstorage where the browser fingerprint will be stored
    const keyLS = 'fingerprint';
    // 2 - Specifying the CSS selector for the button that will be used to call the dialog window with the chatbot
    const chatbotBtnSel = '.chatbot-btn';
    // 3 - URL to index.html
    const url = 'https://tokushimauniv.webhook.office.com/webhookb2/867d3b8b-a2f9-4b72-abfa-844f0e6ed5b1@8671c3a4-4538-47f6-8717-16a1d6b0ca98/IncomingWebhook/b4f60c8e8ac44f7f80c8814cb5ff0aa4/4f7c7e3f-d74d-41d6-b638-cce86cea6d72';
    // 4 - Data description that defines the dialog script for the chatbot
    const data = {
      bot: {
        0: {
          content: 'こんにちは！とくぽんAI塾です。何かご質問はありますか？', human: [0, 1, 2]
        },
        1: { content: 'よかった！あなたのお名前は？', human: [3] },
        2: { content: 'あなたのお名前は？', human: [3] },
        3: { content: '{{name}}, 興味のあることは何ですか？', human: [4, 5] },
        4: { content: '{{name}}, こちらにアクセスしてください。 <a href="https://www.tokushima-u.ac.jp/ai/tokupon/" target="_blank">とくぽんAI塾</a>. こちらに詳しい情報があります。', human: [6] },
        5: { content: "{{name}}, ご質問はなんですか？", human: [7] },
        6: { content: '{{name}}, ご質問を受け付けました。後ほど連絡しますので、連絡先を教えてください。', human: [8, 9] },
        7: { content: '{{name}}, お電話番号を教えてください。', human: [10] },
        8: { content: '{{name}}, Eメールアドレスを教えてください。', human: [10] },
        9: { content: 'OK! {{name}}, 折り返し {{contact}} へご連絡差し上げますので、少々お待ちください。', human: [6] },
        10: { content: 'ありがとう！あなたのお名前は？', human: [3] },
      },
      human: {
        0: { content: '開講時期を知りたい。', bot: 1 },
        1: { content: '特にないです。', bot: 2 },
        2: { content: 'とくぽんかわいいね！', bot: 10 },
        3: { content: '', bot: 3, name: 'name' },
        4: { content: 'とくぽんAI塾に興味があります。', bot: 4 },
        5: { content: 'とくぽんAI塾について聞きたいことがあります。', bot: 5 },
        6: { content: '初めにもどる', bot: 3 },
        7: { content: '', bot: 6, name: '' },
        8: { content: '電話', bot: 7 },
        9: { content: 'Eメール', bot: 8 },
        10: { content: '', bot: 9, name: 'contact' },
      }
    }
    // adding a fingerprint hash to localstorage
		/*
    let fingerprint = localStorage.getItem(keyLS);
    if (!fingerprint) {
      Fingerprint2.get(function (components) {
        fingerprint = Fingerprint2.x64hash128(components.map(function (pair) { return pair.value }).join(), 31)
        localStorage.setItem(keyLS, fingerprint)
      });
    }*/
    // Initializing ChatBotByItchief by calling the following function and passing the required parameters to it
    chatBotByItchiefInit({
      chatbotBtnSel: chatbotBtnSel,
      data: data,
      url: url,
      keyLS: keyLS
    });

    setTimeout(function () {
      const chatbotToggleTooltip = document.querySelector('.chatbot-toggle-tooltip');
      chatbotToggleTooltip.classList.add('chatbot-toggle-tooltip_show');
      setTimeout(function () {
        chatbotToggleTooltip.classList.remove('chatbot-toggle-tooltip_show');
      }, 10000)
    }, 10000)

  </script>

</body>

</html>
